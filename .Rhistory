rownames(interventions) <- ids$nct_id
ids$nct_id
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
interventions$nct_id <- ids$nct_id
interventions
interventions <- xmltodf(parsed, "//intervention")
interventions$nct_id <- ids$nct_id
interventions
interventions <- xmltodf(parsed, "//intervention")
interventions
xmltodf <- function(parse_xml, xpath){
as.data.frame(do.call(rbind, lapply(parsed[xpath], XML::xmlToList)))
}
interventions <- xmltodf(parsed, "//intervention")
interventions$nct_id <- ids$nct_id
interventions
file <- xml_list[1]
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
interventions <- xmltodf(parsed, "//intervention")
interventions
interventions$nct_id <- ids$nct_id
parsed
parsed[["//brief_title"]]
parsed[["//brief_title | //official_title"]]
parsed["//brief_title | //official_title"]
?xpathApply
XML::xpathSApply(parsed, "//brief_title | //official_title", XML::xmlValue)
XML::xpathSApply(parsed, "//brief_title | //official_title", XML::xmlToList)
XML::xpathApply(parsed, "//brief_title | //official_title", XML::xmlToList)
XML::xmlToList(parsed["//brief_title | //official_title"]
)
parsed["//brief_title | //official_title"]
XML::xmlToList(unlist(parsed["//brief_title | //official_title"]))
asXMLNode(unlist(parsed["//brief_title | //official_title"]))
xmlToList(asXMLNode(unlist(parsed["//brief_title | //official_title"])))
parsed[paste0("//", infoterm)]
infoterm <- "condition"
parsed[paste0("//", infoterm)]
parsed[paste0("//", infoterm)][[1]]
xmlValue(parsed[paste0("//", infoterm)][[1]])
study_info <- ids
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)])
}
interventions <- xmltodf(parsed, "//intervention")
interventions$nct_id <- ids$nct_id
}
i
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)])
}
i
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)])
parsed[paste0("//", infoterm)
]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
}
study_info
infoterm <- "end_date"
parsed[[paste0("//", infoterm)]]
infoterm
parsed
infoterm <- "completion_date"
parsed[[paste0("//", infoterm)]]
xmlAttrs(parsed[[paste0("//", infoterm)]])
xmlAttrs(parsed[[paste0("//", infoterm)]])$type
xmlAttrs(parsed[[paste0("//", infoterm)]])["type"]
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
if(infoterm == "completion_date") study_info["end_date_type"] <- XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"]
}
study_info
file <- "~/Desktop/tmp.xml"
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
if(infoterm == "completion_date") study_info["completion_date_type"] <- XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"]
}
study_info
file
file <- xml_list[1]
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
if(infoterm == "completion_date") study_info["completion_date_type"] <- XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"]
}
study_info
parsed
file
file <- xml_list[2]
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- XML::xmlValue(parsed[[paste0("//", infoterm)]])
if(infoterm == "completion_date") study_info["completion_date_type"] <- XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"]
}
parsed
i
infoterms[5]
parsed
xmlAttrs(NA)
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(myXmlValueXML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
interventions$nct_id <- ids$nct_id
study_info
parsed
i
i <- 1
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(myXmlValueXML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
myXmlValueXML::xmlValue(parsed[[paste0("//", infoterm)]])
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
study_info
interventions <- xmltodf(parsed, "//intervention")
interventions
interventions$nct_id <- ids$nct_id
file
file <- "~/Desktop/tmp.xml"
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0) interventions$nct_id <- ids$nct_id
interventions
parsed
parsed <- XML::xmlParse(file)
file
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0) interventions$nct_id <- ids$nct_id
interventions
if(nrow(interventions) == 1) study_info <- merge(study_info, interventions, by = "nct_id")
study_info
parsed
parsed["//textblock"]
xmltodf(parsed, "//textblock")
as.list(xmltodf(parsed, "//textblock"))
textblocks <- xmltodf(parsed, "//textblock")
if(nrow(textblocks) > 0) textblocks$nct_id <- ids$nct_id
textblocks
parsed["//location"]
xmlToList(parsed[["//location"]])
as.data.frame(xmlToList(parsed[["//location"]]))
as.data.frame(xmlToList(parsed["//facility"]))
xmltodf(parsed, "//facility")
file
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0) interventions$nct_id <- ids$nct_id
if(nrow(interventions) == 1) study_info <- merge(study_info, interventions, by = "nct_id")
## big text fields
textblocks <- xmltodf(parsed, "//textblock")
if(nrow(textblocks) > 0) textblocks$nct_id <- ids$nct_id
xmltodf(parsed, "//facility")
parsed["//lead_sponsor"]
parsed[["//lead_sponsor"]]
xmlValue(parsed[["//lead_sponsor"]])
xmlValue(parsed[["//lead_sponsor/agency"]])
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date", "lead_sponsor/agency",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
study_info
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0) interventions$nct_id <- ids$nct_id
if(nrow(interventions) == 1) study_info <- merge(study_info, interventions, by = "nct_id")
## big text fields
textblocks <- xmltodf(parsed, "//textblock")
if(nrow(textblocks) > 0) textblocks$nct_id <- ids$nct_id
## locations
locations <- xmltodf(parsed, "//facility")
if(nrow(locations) > 0) locations$nct_id <- ids$nct_id
locations
library(plyr)
?rbind.fill
merge(study_info, interventions, by = "nct_id")
merge(merge(study_info, interventions, by = "nct_id"), locations, by = "nct_id")
merge(merge(study_info, interventions, by = "nct_id"), data.frame(NULL), by = "nct_id")
data.frame(NULL)
textblocks <- FALSE
xmllist
xml_list
# convert study xml to a data frame
parse_study_xml <- function(file, textblocks = FALSE){
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date", "lead_sponsor/agency",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0){
interventions$nct_id <- ids$nct_id
study_info <- merge(study_info, interventions, by = "nct_id")
}
## big text fields
textblocks <- xmltodf(parsed, "//textblock")
if(nrow(textblocks) > 0 & textblocks){
textblocks$nct_id <- ids$nct_id
study_info <- merge(study_info, textblocks, by = "nct_id")
}
## locations
locations <- xmltodf(parsed, "//facility")
if(nrow(locations) > 0){
locations$nct_id <- ids$nct_id
study_info <- merge(study_info, locations, by = "nct_id")
}
study_info
}
xmltodf <- function(parse_xml, xpath){
as.data.frame(do.call(rbind, lapply(parsed[xpath], XML::xmlToList)))
}
info_list <- lapply(xml_list, parse_study_xml, textblocks)
include_textblocks <- FALSE
info_list <- lapply(xml_list, parse_study_xml, include_textblocks)
file <- xml_list[1]
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date", "lead_sponsor/agency",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0){
interventions$nct_id <- ids$nct_id
study_info <- merge(study_info, interventions, by = "nct_id")
}
## big text fields
textblocks <- xmltodf(parsed, "//textblock")
textblocks
nrow(textblocks)
for(i in xml_list){
parse_study_xml(i)
}
i
xml_list
parse_study_xml <- function(file, include_textblocks = FALSE){
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date", "lead_sponsor/agency",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0){
interventions$nct_id <- ids$nct_id
study_info <- merge(study_info, interventions, by = "nct_id")
}
## big text fields
textblocks <- xmltodf(parsed, "//textblock")
if(nrow(textblocks) > 0 && include_textblocks){
textblocks$nct_id <- ids$nct_id
study_info <- merge(study_info, textblocks, by = "nct_id")
}
## locations
locations <- xmltodf(parsed, "//facility")
if(nrow(locations) > 0){
locations$nct_id <- ids$nct_id
study_info <- merge(study_info, locations, by = "nct_id")
}
study_info
}
xmltodf <- function(parse_xml, xpath){
as.data.frame(do.call(rbind, lapply(parsed[xpath], XML::xmlToList)))
}
for(i in xml_list){
parse_study_xml(i)
}
info_list <- lapply(xml_list, parse_study_xml, include_textblocks)
info_list
do.call(plyr::rbind.fill, info_list)
query <- "myeloma"
count <- 10
frame <- clinicaltrials_search(query, count)
frame
query_url <- "http://clinicaltrials.gov/ct2/results?id="
final_url <- paste0(query_url, paste(frame$nct_id, collapse = "+OR+"))
inc_res <- ifelse(include_results, "&resultxml=true", "&studyxml=true")
search_result <- httr::GET(paste0(final_url, inc_res))
## download and unzip to a temporary directory
tmpzip <- tempfile(fileext = ".zip")
tmpdir <- gsub(".zip", "/", tmpzip, fixed = TRUE)
writeBin(httr::content(search_result, as = "raw"), tmpzip)
unzip(tmpzip, exdir = tmpdir)
# get files list
xml_list <- paste0(tmpdir, list.files(path = tmpdir))
info_list <- lapply(xml_list, parse_study_xml, include_textblocks)
# convert to dataframe
do.call(plyr::rbind.fill, info_list)
xml_list
file <- xml_list[1]
parsed <- XML::xmlParse(file)
date_disclaimer <- XML::xmlValue(parsed[["//download_date"]])
ids <- as.data.frame(XML::xmlToList(parsed[["//id_info"]]), stringsAsFactors = FALSE)
## basic study info
infoterms <- c("brief_title", "official_title", "overall_status", "start_date", "completion_date", "lead_sponsor/agency",
"phase", "study_type", "study_design", "enrollment", "primary_condition")
study_info <- ids
for(i in 1:length(infoterms)){
if(infoterms[i] == "primary_condition"){
infoterm <- "condition"
study_info[infoterms[i]] <- XML::xmlValue(parsed[paste0("//", infoterm)][[1]])
} else {
infoterm <- infoterms[i]
study_info[infoterms[i]] <- tryCatch(XML::xmlValue(parsed[[paste0("//", infoterm)]]), error = function(e) NA)
if(infoterm == "completion_date") study_info["completion_date_type"] <- tryCatch(XML::xmlAttrs(parsed[[paste0("//", infoterm)]])["type"], error = function(e) NA)
}
interventions <- xmltodf(parsed, "//intervention")
if(nrow(interventions) > 0){
interventions$nct_id <- ids$nct_id
study_info <- merge(study_info, interventions, by = "nct_id")
}
interventions
interventions <- xmltodf(parsed, "//intervention")
parsed[//intervention]
parsed["//intervention"]
xmltodf <- function(parse_xml, xpath){
as.data.frame(do.call(plyr::rbind.fill, lapply(parsed[xpath], XML::xmlToList)))
}
interventions <- xmltodf(parsed, "//intervention")
xmltodf <- function(parse_xml, xpath){
as.data.frame(do.call(plyr::rbind.fill, lapply(parsed[xpath], function(x) as.data.frame(XML::xmlToList(x)))))
}
interventions <- xmltodf(parsed, "//intervention")
interventions
source('/Volumes/home02/SachsMc/R projects/rclinicaltrials/R/clinicaltrials_download.R')
info_list <- lapply(xml_list, parse_study_xml, include_textblocks)
do.call(plyr::rbind.fill, info_list)
fri <- do.call(plyr::rbind.fill, info_list)
attr(fri)
source('/Volumes/home02/SachsMc/R projects/rclinicaltrials/R/clinicaltrials_download.R')
xml_list <- paste0(tmpdir, list.files(path = tmpdir))
info_list <- lapply(xml_list, parse_study_xml, include_textblocks)
# convert to dataframe
do.call(plyr::rbind.fill, info_list)
locations <- xmltodf(parsed, "//facility")
locations
library(rclinicaltrials)
source('/Volumes/home02/SachsMc/R projects/rclinicaltrials/R/clinicaltrials_download.R')
